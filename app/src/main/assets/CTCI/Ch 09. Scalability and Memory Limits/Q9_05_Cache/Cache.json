{"Id":"db50ee51-7e30-4b3d-8a23-39668c6d48d0","Topic":"Ch 09. Scalability and Memory Limits","Question":"","Solution":"package Q9_05_Cache;\r\n\r\nimport java.util.HashMap;\r\n\r\npublic class Cache {\r\n\tpublic static int MAX_SIZE = 10;\r\n\tpublic Node head;\r\n\tpublic Node tail;\r\n\tpublic HashMap<String, Node> map;\r\n\tpublic int size = 0;\r\n\t\r\n\tpublic Cache() {\r\n\t\tmap = new HashMap<String, Node>();\r\n\t}\r\n\t\r\n\tpublic void moveToFront(Node node) {\r\n\t\tif (node == head) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tremoveFromLinkedList(node);\r\n\t\tnode.next = head;\r\n\t\tif (head != null) {\r\n\t\t\thead.prev = node;\r\n\t\t}\r\n\t\thead = node;\r\n\t\tsize++;\r\n\t\t\r\n\t\tif (tail == null) {\r\n\t\t\ttail = node;\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic void moveToFront(String query) {\r\n\t\tNode node = map.get(query);\r\n\t\tmoveToFront(node);\r\n\t}\t\r\n\t\r\n\tpublic void removeFromLinkedList(Node node) {\r\n\t\tif (node == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (node.next != null || node.prev != null) {\r\n\t\t\tsize--;\r\n\t\t}\r\n\t\t\r\n\t\tNode prev = node.prev;\r\n\t\tif (prev != null) {\r\n\t\t\tprev.next = node.next;\r\n\t\t} \r\n\t\t\r\n\t\tNode next = node.next;\r\n\t\tif (next != null) {\r\n\t\t\tnext.prev = prev;\r\n\t\t}\r\n\t\t\r\n\t\tif (node == head) {\r\n\t\t\thead = next;\r\n\t\t}\r\n\t\t\r\n\t\tif (node == tail) {\r\n\t\t\ttail = prev;\r\n\t\t}\r\n\t\t\r\n\t\tnode.next = null;\r\n\t\tnode.prev = null;\r\n\t}\r\n\t\r\n\tpublic String[] getResults(String query) {\r\n\t\tif (map.containsKey(query)) {\r\n\t\t\tNode node = map.get(query);\r\n\t\t\tmoveToFront(node);\r\n\t\t\treturn node.results;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\tpublic void insertResults(String query, String[] results) {\r\n\t\tif (map.containsKey(query)) {\r\n\t\t\tNode node = map.get(query);\r\n\t\t\tnode.results = results;\r\n\t\t\tmoveToFront(node);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tNode node = new Node(query, results);\r\n\t\tmoveToFront(node);\r\n\t\tmap.put(query, node);\r\n\t\t\r\n\t\tif (size > MAX_SIZE) {\r\n\t\t\tmap.remove(tail.query);\r\n\t\t\tremoveFromLinkedList(tail);\r\n\t\t}\r\n\t}\r\n}\r\n","Chapter":"Ch 09. Scalability and Memory Limits"}