{"Id":"a4ede1f6-172a-4b9c-8f71-faaa62239175","Topic":"Ch 17. Hard","Question":"","Solution":"package Q17_12_BiNode;\r\n\r\n\r\npublic class QuestionC {\r\n\r\n\tpublic static void printAsTree(BiNode root, String spaces) {\r\n\t\tif (root == null) {\r\n\t\t\tSystem.out.println(spaces + \"- null\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tSystem.out.println(spaces + \"- \" + root.data);\r\n\t\tprintAsTree(root.node1, spaces + \"   \");\r\n\t\tprintAsTree(root.node2, spaces + \"   \");\r\n\t}\r\n\t\r\n\tpublic static BiNode createTree() {\r\n\t\tBiNode[] nodes = new BiNode[7];\r\n\t\tfor (int i = 0; i < nodes.length; i++) {\r\n\t\t\tnodes[i] = new BiNode(i);\r\n\t\t}\r\n\t\tnodes[4].node1 = nodes[2];\r\n\t\tnodes[4].node2 = nodes[5];\r\n\t\tnodes[2].node1 = nodes[1];\r\n\t\tnodes[2].node2 = nodes[3];\r\n\t\tnodes[5].node2 = nodes[6];\r\n\t\tnodes[1].node1 = nodes[0];\r\n\t\treturn nodes[4];\r\n\t}\r\n\t\r\n\tpublic static void printLinkedListTree(BiNode root) {\r\n\t\tfor (BiNode node = root; node != null; node = node.node2) {\r\n\t\t\tif (node.node2 != null && node.node2.node1 != node) {\r\n\t\t\t\tSystem.out.print(\"inconsistent node: \" + node);\r\n\t\t\t}\r\n\t\t\tSystem.out.print(node.data + \"->\");\r\n\t\t}\r\n\t\tSystem.out.println();\r\n\t}\r\n\t\r\n\tpublic static BiNode convertToCircular(BiNode root) {\r\n\t\tif (root == null) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\t\r\n\t\tBiNode part1 = convertToCircular(root.node1);\r\n\t\tBiNode part3 = convertToCircular(root.node2);\r\n\t\t\t\t\r\n\t\tif (part1 == null && part3 == null) {\r\n\t\t\troot.node1 = root;\r\n\t\t\troot.node2 = root;\r\n\t\t\treturn root;\r\n\t\t}\r\n\t\tBiNode tail3 = part3 == null ? null : part3.node1;\r\n\t\t\r\n\t\t/* join left to root */\r\n\t\tif (part1 == null) {\r\n\t\t\tconcat(part3.node1, root);\r\n\t\t} else {\r\n\t\t\tconcat(part1.node1, root);\r\n\t\t}\r\n\t\t\r\n\t\t/* join right to root */\r\n\t\tif (part3 == null) {\r\n\t\t\tconcat(root, part1);\r\n\t\t} else {\r\n\t\t\tconcat(root, part3);\r\n\t\t}\r\n\t\t\r\n\t\t/* join right to left */\r\n\t\tif (part1 != null && part3 != null) {\r\n\t\t\tconcat(tail3, part1);\r\n\t\t}\r\n\t\t\r\n\t\treturn part1 == null ? root : part1;\r\n\t}\r\n\t\r\n\tpublic static BiNode convert(BiNode root) {\r\n\t\tBiNode head = convertToCircular(root);\r\n\t\thead.node1.node2 = null;\r\n\t\thead.node1 = null;\r\n\t\treturn head;\r\n\t}\r\n\t\r\n\tpublic static void concat(BiNode x, BiNode y) {\r\n\t\tx.node2 = y;\r\n\t\ty.node1 = x;\r\n\t}\r\n\t\r\n\tpublic static void main(String[] args) {\r\n\t\tBiNode root = createTree();\r\n\t\tprintAsTree(root, \"\");\r\n\t\tBiNode r = convert(root);\r\n\t\tprintLinkedListTree(r);\r\n\t}\r\n\r\n}\r\n","Chapter":"Ch 17. Hard"}